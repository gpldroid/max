<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="DAMI X-PRO - Ø£ÙØ¶Ù„ Ù…Ù†ØµØ© Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª ÙˆØ§Ù„Ø£ÙÙ„Ø§Ù… ÙˆØ§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©">
    <meta name="keywords" content="DAMI X-PRO, IPTV, Live TV, Movies, Series, Imad Eddine Lamrani">
    <meta name="author" content="Imad Eddine Lamrani">
    
    <meta property="og:title" content="DAMI X-PRO | Ø¹Ù…Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ù„Ù…Ø±Ø§Ù†ÙŠ">
    <meta property="og:description" content="Ø£ÙØ¶Ù„ Ù…Ù†ØµØ© Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª ÙˆØ§Ù„Ø£ÙÙ„Ø§Ù… ÙˆØ§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©">
    <meta property="og:image" content="https://cdn-icons-png.flaticon.com/512/2965/2965363.png">
    
    <title>DAMI X-PRO | Ø¹Ù…Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ù„Ù…Ø±Ø§Ù†ÙŠ</title>
    
    <link rel="shortcut icon" href="https://cdn-icons-png.flaticon.com/512/2965/2965363.png" type="image/x-icon">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg-body: #050505; --bg-card: #121212; --bg-sidebar: rgba(18, 18, 18, 0.98);
            --text-main: #ffffff; --text-secondary: #a1a1aa; --accent-color: #d4af37;
            --border-color: rgba(212, 175, 55, 0.15); --gradient-accent: linear-gradient(135deg, #d4af37 0%, #bf953f 100%);
        }
        .light-mode {
            --bg-body: #F0F2F5; --bg-card: #FFFFFF; --bg-sidebar: #FFFFFF;
            --text-main: #050505; --text-secondary: #65676B; --accent-color: #1877F2; --border-color: #dddfe2;
        }
        body { background-color: var(--bg-body); color: var(--text-main); font-family: 'Cairo', sans-serif; transition: 0.3s; overflow-x: hidden; }
        
        /* Sidebar */
        .sidebar { position: fixed; top: 0; right: -300px; width: 280px; height: 100%; background: var(--bg-sidebar); backdrop-filter: blur(15px); z-index: 1000; transition: 0.4s; padding: 20px; box-shadow: -5px 0 20px rgba(0,0,0,0.5); }
        .sidebar.open { right: 0; }
        html[dir="ltr"] .sidebar { right: auto; left: -300px; }
        html[dir="ltr"] .sidebar.open { left: 0; }
        .sidebar-link { display: flex; align-items: center; gap: 15px; padding: 12px; border-radius: 12px; cursor: pointer; transition: 0.3s; color: var(--text-main); }
        .sidebar-link:hover { background: rgba(212, 175, 55, 0.1); color: var(--accent-color); }

        /* Floating buttons */
        .whatsapp-btn { position: fixed; bottom: 30px; left: 30px; width: 60px; height: 60px; background: #25d366; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); z-index: 999; }
        .back-to-top { position: fixed; bottom: 105px; left: 35px; width: 50px; height: 50px; background: var(--accent-color); color: white; border-radius: 50%; display: none; align-items: center; justify-content: center; font-size: 20px; cursor: pointer; z-index: 998; transition: 0.3s; }
        .back-to-top.show { display: flex; }

        .media-card { background: var(--bg-card); border-radius: 12px; padding: 10px; border: 1px solid var(--border-color); transition: 0.3s; cursor: pointer; }
        .media-card:hover { border-color: var(--accent-color); transform: translateY(-5px); }
        .mode-btn.active { background: var(--gradient-accent); color: white; }
        
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 20px; }
        .modal-content { background: var(--bg-card); padding: 30px; border-radius: 20px; max-width: 500px; width: 100%; border: 1px solid var(--accent-color); text-align: center; }
        
        /* Loader */
        .loader { border: 4px solid rgba(255,255,255,0.1); border-left-color: var(--accent-color); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Chrome Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
        .pip-notification { position: fixed; top: 20px; right: 20px; background: var(--accent-color); color: white; padding: 12px 20px; border-radius: 8px; z-index: 3000; display: none; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .quality-badge { position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.7); color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; z-index: 10; }
        .buffer-indicator { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.8); color: white; padding: 15px 25px; border-radius: 10px; display: none; z-index: 20; }
    </style>
</head>
<body>

    <a href="https://wa.me/212783539816" target="_blank" class="whatsapp-btn"><i class="fab fa-whatsapp"></i></a>
    <div id="backToTop" class="back-to-top" onclick="window.scrollTo({top:0, behavior:'smooth'})"><i class="fas fa-arrow-up"></i></div>

    <!-- Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙˆØ±Ø© -->
    <div id="pipNotification" class="pip-notification">
        <i class="fas fa-picture-in-picture mr-2"></i>
        <span data-translate="pip_active">Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¹Ù…Ù„ ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙˆØ±Ø©</span>
    </div>

    <div id="overlay" class="fixed inset-0 bg-black/60 z-[999] hidden" onclick="toggleSidebar()"></div>

    <aside id="sidebar" class="sidebar">
        <div class="flex justify-between items-center mb-8 pb-4 border-b border-[var(--border-color)]">
            <div class="text-xl font-black text-[var(--accent-color)]">DAMI X-PRO</div>
            <i class="fas fa-times cursor-pointer text-xl" onclick="toggleSidebar()"></i>
        </div>
        <nav>
            <div class="sidebar-link" onclick="location.reload()"><i class="fas fa-home"></i> <span data-translate="home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></div>
            <div class="sidebar-link" onclick="openModal('about')"><i class="fas fa-info-circle"></i> <span data-translate="about">Ù…Ù† Ù†Ø­Ù†</span></div>
            <div class="sidebar-link" onclick="window.open('https://wa.me/212783539816')"><i class="fas fa-envelope"></i> <span data-translate="contact">Ø§ØªØµÙ„ Ø¨Ù†Ø§</span></div>
            <div class="sidebar-link" onclick="openModal('privacy')"><i class="fas fa-user-shield"></i> <span data-translate="privacy">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</span></div>
            <div class="my-4 border-t border-[var(--border-color)]"></div>
            <a href="https://dami-xpro.com/download" class="sidebar-link" style="background: var(--gradient-accent); color: white;">
                <i class="fab fa-android" style="color: white;"></i> <span data-translate="download_app">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</span>
            </a>
        </nav>
    </aside>

    <header class="bg-[var(--bg-card)] border-b border-[var(--border-color)] sticky top-0 z-[50] p-4 flex justify-between items-center">
        <div class="flex items-center gap-4">
            <i class="fas fa-bars cursor-pointer text-xl" onclick="toggleSidebar()"></i>
            <div class="text-xl font-bold"><span class="text-[var(--accent-color)]">DAMI</span> X-PRO</div>
        </div>
        <div class="flex items-center gap-3">
            <select id="langSelect" onchange="changeLanguage(this.value)" class="bg-transparent border border-[var(--border-color)] rounded-lg px-2 py-1 text-sm outline-none text-[var(--text-main)]">
                <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                <option value="en">English</option>
                <option value="fr">FranÃ§ais</option>
                <option value="es">EspaÃ±ol</option>
            </select>
            <div class="w-10 h-10 rounded-full flex items-center justify-center bg-gray-800/50 cursor-pointer" onclick="toggleTheme()">
                <i class="fas fa-moon" id="themeIcon"></i>
            </div>
        </div>
    </header>

    <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø´ØºÙ„ Ù…Ø¹ Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div class="player-wrapper w-full bg-black flex justify-center relative">
        <div id="bufferIndicator" class="buffer-indicator">
            <div class="loader small"></div>
            <div class="mt-2" data-translate="buffering">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>
        <video id="player" playsinline controls crossorigin class="w-full max-w-5xl aspect-video"></video>
    </div>

    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø© -->
    <div id="qualityInfo" class="quality-badge hidden">1080p â€¢ 60fps</div>

    <main class="max-w-7xl mx-auto p-4">
        <div class="relative max-w-2xl mx-auto my-8">
            <input type="text" id="searchInput" class="w-full bg-[var(--bg-card)] border-2 border-[var(--border-color)] rounded-full py-3 px-12 outline-none focus:border-[var(--accent-color)] text-[var(--text-main)]" placeholder="Ø§Ø¨Ø­Ø« Ù‡Ù†Ø§..." data-translate-placeholder="search">
            <i class="fas fa-search absolute right-5 top-1/2 -translate-y-1/2 text-gray-500"></i>
        </div>

        <div class="flex max-w-md mx-auto bg-[var(--bg-card)] border border-[var(--border-color)] p-1 rounded-2xl mb-8">
            <button onclick="switchMode('live')" class="mode-btn active flex-1 py-2 rounded-xl text-sm font-bold" data-mode="live"><span data-translate="live">Ù…Ø¨Ø§Ø´Ø±</span></button>
            <button onclick="switchMode('movies')" class="mode-btn flex-1 py-2 rounded-xl text-sm font-bold" data-mode="movies"><span data-translate="movies">Ø£ÙÙ„Ø§Ù…</span></button>
            <button onclick="switchMode('series')" class="mode-btn flex-1 py-2 rounded-xl text-sm font-bold" data-mode="series"><span data-translate="series">Ù…Ø³Ù„Ø³Ù„Ø§Øª</span></button>
        </div>

        <div id="categoriesContainer" class="flex overflow-x-auto gap-2 pb-4 mb-6 scrollbar-hide" style="-ms-overflow-style: none; scrollbar-width: none;"></div>
        <div id="contentGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4"></div>
        <div id="loader" class="hidden"><div class="loader"></div></div>
        <button id="loadMoreBtn" onclick="loadMore()" class="hidden mx-auto mt-8 bg-[var(--bg-card)] border border-[var(--accent-color)] text-[var(--accent-color)] px-10 py-2 rounded-full font-bold hover:bg-[var(--accent-color)] hover:text-white transition" data-translate="load_more">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯</button>
    </main>

    <footer class="bg-[var(--bg-card)] border-t border-[var(--border-color)] p-10 text-center mt-20">
        <a href="https://dami-xpro.com/download" class="inline-flex items-center gap-3 bg-[var(--accent-color)] text-white px-8 py-3 rounded-full font-bold mb-8 hover:scale-105 transition">
            <i class="fab fa-android"></i> <span data-translate="download_app">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</span>
        </a>
        <p class="font-bold text-xl mb-2 text-[var(--text-main)]">DAMI X-PRO &copy; <span id="year"></span></p>
        <p class="text-gray-500">Designed & Developed by <span class="text-[var(--accent-color)]">Imad Eddine Lamrani</span></p>
    </footer>

    <div id="modal-about" class="modal" onclick="closeModal('about')">
        <div class="modal-content text-center" onclick="event.stopPropagation()">
            <h2 class="text-2xl font-bold text-[var(--accent-color)] mb-4" data-translate="about">Ù…Ù† Ù†Ø­Ù†</h2>
            <p class="text-[var(--text-secondary)]">DAMI X-PRO ØªØ·Ø¨ÙŠÙ‚ Ø±Ø§Ø¦Ø¯ Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ±ÙÙŠÙ‡ÙŠ Ø¨Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ©. ØªÙ… ØªØ·ÙˆÙŠØ± Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨ÙˆØ§Ø³Ø·Ø© Ø¹Ù…Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ù„Ù…Ø±Ø§Ù†ÙŠ.</p>
            <button class="mt-6 px-8 py-2 bg-[var(--accent-color)] text-white rounded-lg" onclick="closeModal('about')" data-translate="close">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <div id="modal-privacy" class="modal" onclick="closeModal('privacy')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h2 class="text-2xl font-bold text-[var(--accent-color)] mb-4 text-center" data-translate="privacy">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</h2>
            <p class="text-[var(--text-secondary)] text-sm">Ù†Ø­Ù† Ù†Ø­ØªØ±Ù… Ø®ØµÙˆØµÙŠØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†. Ù„Ø§ Ù†Ù‚ÙˆÙ… Ø¨Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ø®ØµÙŠØ© Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ Ø®Ø§Ø±Ø¬ Ù†Ø·Ø§Ù‚ ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ.</p>
            <button class="mt-6 w-full py-2 bg-[var(--accent-color)] text-white rounded-lg" onclick="closeModal('privacy')" data-translate="agree">Ù…ÙˆØ§ÙÙ‚</button>
        </div>
    </div>

    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.10/dist/hls.min.js"></script>

    <script>
        // ============= CONFIGURATION =============
        const CONFIG = {
            api: { base: "https://x-api.uk", user: "CYNLgSSx45n", pass: "cp2p92dJWjMf" }
        };

        // Ø§Ù„ØªØ±Ø¬Ù…Ø§Øª Ø§Ù„Ù…ÙˆØ³Ø¹Ø©
        const translations = {
            ar: { home: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", about: "Ù…Ù† Ù†Ø­Ù†", contact: "Ø§ØªØµÙ„ Ø¨Ù†Ø§", privacy: "Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©", 
                  download_app: "ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚", live: "Ù…Ø¨Ø§Ø´Ø±", movies: "Ø£ÙÙ„Ø§Ù…", series: "Ù…Ø³Ù„Ø³Ù„Ø§Øª", 
                  all: "Ø§Ù„ÙƒÙ„", search: "Ø§Ø¨Ø­Ø« Ù‡Ù†Ø§...", load_more: "Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯", close: "Ø¥ØºÙ„Ø§Ù‚", 
                  agree: "Ù…ÙˆØ§ÙÙ‚", buffering: "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...", pip_active: "Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¹Ù…Ù„ ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙˆØ±Ø©",
                  quality: "Ø¬ÙˆØ¯Ø©", auto: "ØªÙ„Ù‚Ø§Ø¦ÙŠ", low: "Ù…Ù†Ø®ÙØ¶Ø©", medium: "Ù…ØªÙˆØ³Ø·Ø©", high: "Ø¹Ø§Ù„ÙŠØ©" },
            en: { home: "Home", about: "About Us", contact: "Contact", privacy: "Privacy", 
                  download_app: "Download App", live: "Live TV", movies: "Movies", series: "Series", 
                  all: "All", search: "Search here...", load_more: "Load More", close: "Close", 
                  agree: "Agree", buffering: "Buffering...", pip_active: "Video is playing in Picture-in-Picture",
                  quality: "Quality", auto: "Auto", low: "Low", medium: "Medium", high: "High" },
            fr: { home: "Accueil", about: "Ã€ propos", contact: "Contact", privacy: "PrivÃ©e", 
                  download_app: "TÃ©lÃ©charger", live: "Direct", movies: "Films", series: "SÃ©ries", 
                  all: "Tout", search: "Chercher...", load_more: "Charger plus", close: "Fermer", 
                  agree: "D'accord", buffering: "Mise en mÃ©moire tampon...", pip_active: "La vidÃ©o est lue en image dans l'image",
                  quality: "QualitÃ©", auto: "Auto", low: "Basse", medium: "Moyenne", high: "Haute" },
            es: { home: "Inicio", about: "Nosotros", contact: "Contacto", privacy: "Privacidad", 
                  download_app: "Descargar", live: "En vivo", movies: "PelÃ­culas", series: "Series", 
                  all: "Todo", search: "Buscar...", load_more: "Cargar mÃ¡s", close: "Cerrar", 
                  agree: "Aceptar", buffering: "Cargando...", pip_active: "El video se reproduce en imagen dentro de imagen",
                  quality: "Calidad", auto: "AutomÃ¡tico", low: "Baja", medium: "Media", high: "Alta" }
        };

        // ============= STATE VARIABLES =============
        let currentLang = 'ar';
        let currentMode = 'live';
        let allData = [];
        let displayedCount = 0;
        let hlsInstance = null;
        let plyrPlayer = null;
        let userInteracted = false;
        let isBuffering = false;

        // ============= CHROME AUTOPLAY HELPER =============
        // Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙÙŠ Chrome
        function initAutoplayHelper() {
            // ØªÙØ¹ÙŠÙ„ Ø¹Ù†Ø¯ Ø£ÙŠ ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„ØµÙØ­Ø©
            const enablePlayback = () => {
                userInteracted = true;
                console.log("âœ“ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ´ØºÙŠÙ„: ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„");
            };
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„ØªÙØ§Ø¹Ù„
            document.addEventListener('click', enablePlayback);
            document.addEventListener('touchstart', enablePlayback);
            document.addEventListener('keydown', enablePlayback);
            
            // Ø²Ø± ØªÙØ¹ÙŠÙ„ ÙŠØ¯ÙˆÙŠ Ù„Ù„Ø·ÙˆØ§Ø±Ø¦
            const manualButton = `<button id="enablePlaybackBtn" style="position:fixed;bottom:80px;right:20px;z-index:999;background:#d4af37;color:white;padding:10px 15px;border-radius:8px;display:none;">
                <i class="fas fa-play-circle mr-2"></i>ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ´ØºÙŠÙ„
            </button>`;
            document.body.insertAdjacentHTML('beforeend', manualButton);
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø²Ø± Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ ØªÙØ§Ø¹Ù„ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†
            setTimeout(() => {
                if (!userInteracted) {
                    document.getElementById('enablePlaybackBtn').style.display = 'block';
                }
            }, 3000);
            
            document.getElementById('enablePlaybackBtn').addEventListener('click', function() {
                enablePlayback();
                this.style.display = 'none';
            });
        }

        // Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¢Ù…Ù† Ù…Ø¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ÙˆØ¹ÙˆØ¯ Chrome
        async function safePlay(videoElement) {
            if (!userInteracted) {
                console.log("â³ ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…...");
                showBufferIndicator();
                return false;
            }
            
            try {
                const playPromise = videoElement.play();
                if (playPromise !== undefined) {
                    await playPromise;
                    hideBufferIndicator();
                    return true;
                }
            } catch (error) {
                console.warn("âš ï¸ ÙØ´Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØŒ Ø¬Ø±Ø¨ Ù…Ø¹ ÙƒØªÙ… Ø§Ù„ØµÙˆØª:", error);
                
                // Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø¹ ÙƒØªÙ… Ø§Ù„ØµÙˆØª (Ù…Ø³Ù…ÙˆØ­ ÙÙŠ Ø³ÙŠØ§Ø³Ø© Chrome)
                try {
                    videoElement.muted = true;
                    await videoElement.play();
                    hideBufferIndicator();
                    
                    // Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª
                    setTimeout(() => {
                        showNotification("ÙŠÙ…ÙƒÙ†Ùƒ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª Ø¨Ø¹Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„", "info", 3000);
                    }, 1000);
                    
                    return true;
                } catch (mutedError) {
                    console.error("âŒ ÙØ´Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø­ØªÙ‰ Ù…Ø¹ ÙƒØªÙ… Ø§Ù„ØµÙˆØª:", mutedError);
                    showNotification("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù„Ù„Ø¨Ø¯Ø£", "warning", 5000);
                    return false;
                }
            }
        }

        // ============= ENHANCED PLAYBACK ENGINE =============
        function playStream(id, ext) {
            const video = document.getElementById('player');
            const bufferIndicator = document.getElementById('bufferIndicator');
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
            showBufferIndicator();
            
            // ØªÙ†Ø¸ÙŠÙ Ø£ÙŠ Ù…Ø«ÙŠÙ„ HLS Ø³Ø§Ø¨Ù‚
            if (hlsInstance) {
                hlsInstance.destroy();
                hlsInstance = null;
            }
            
            // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØ¥Ù†Ø´Ø§Ø¡ URL
            let streamUrl, mimeType, isHLS = false;
            
            if (currentMode === 'live') {
                // Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (HLS)
                streamUrl = `${CONFIG.api.base}/live/${CONFIG.api.user}/${CONFIG.api.pass}/${id}.m3u8`;
                mimeType = 'application/x-mpegURL';
                isHLS = true;
                console.log(`ğŸ“º ØªØ´ØºÙŠÙ„ Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±: ${id}`);
                
            } else {
                // Ø§Ù„Ø£ÙÙ„Ø§Ù… ÙˆØ§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª (VOD)
                let extension = ext ? ext.replace('.', '').toLowerCase() : 'mp4';
                
                // Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Chrome
                if (['avi', 'mkv', 'mov', 'wmv'].includes(extension)) {
                    // Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ HLS Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Chrome
                    streamUrl = `${CONFIG.api.base}/movie/${CONFIG.api.user}/${CONFIG.api.pass}/${id}.m3u8`;
                    mimeType = 'application/x-mpegURL';
                    isHLS = true;
                    console.log(`ğŸ”„ ØªØ­ÙˆÙŠÙ„ ${extension} Ø¥Ù„Ù‰ HLS Ù„Ù„ØªÙˆØ§ÙÙ‚`);
                } else {
                    // Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø© Ù…Ø¨Ø§Ø´Ø±Ø© (mp4, webm)
                    streamUrl = `${CONFIG.api.base}/movie/${CONFIG.api.user}/${CONFIG.api.pass}/${id}.${extension}`;
                    mimeType = `video/${extension === 'mp4' ? 'mp4' : extension}`;
                    console.log(`ğŸ¬ ØªØ´ØºÙŠÙ„ VOD: ${extension}`);
                }
            }
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø´ØºÙ„ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†ÙˆØ¹
            if (isHLS && Hls.isSupported()) {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… HLS.js Ù„Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø£Ùˆ VOD Ø§Ù„Ù…Ø­ÙˆÙ„
                hlsInstance = new Hls({
                    enableWorker: true,
                    lowLatencyMode: true,
                    backBufferLength: 90,
                    maxBufferSize: 30 * 1000 * 1000, // 30MB
                    maxBufferLength: 30,
                    maxMaxBufferLength: 60
                });
                
                hlsInstance.loadSource(streamUrl);
                hlsInstance.attachMedia(video);
                
                // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø­Ø¯Ø§Ø« HLS
                hlsInstance.on(Hls.Events.MANIFEST_PARSED, () => {
                    console.log("âœ… ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø§Ù†ÙŠÙØ³Øª Ø¨Ù†Ø¬Ø§Ø­");
                    safePlay(video);
                    setupQualitySelector(hlsInstance);
                });
                
                hlsInstance.on(Hls.Events.ERROR, (event, data) => {
                    console.error("âŒ Ø®Ø·Ø£ HLS:", data);
                    handlePlaybackError(data, streamUrl);
                });
                
                // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
                hlsInstance.on(Hls.Events.FRAG_LOADING, () => {
                    showBufferIndicator();
                });
                
                hlsInstance.on(Hls.Events.FRAG_LOADED, () => {
                    hideBufferIndicator();
                });
                
            } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                // Ø¯Ø¹Ù… Safari Ø§Ù„Ø£ØµÙ„ÙŠ Ù„Ù€ HLS
                video.src = streamUrl;
                safePlay(video);
                
            } else {
                // Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø¹Ø§Ø¯ÙŠ (MP4, WebM)
                video.src = streamUrl;
                video.type = mimeType;
                
                video.addEventListener('loadeddata', () => {
                    console.log("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ");
                    hideBufferIndicator();
                    safePlay(video);
                });
                
                video.addEventListener('error', (e) => {
                    console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ:", e);
                    handlePlaybackError({ type: 'MEDIA_ERROR' }, streamUrl);
                });
            }
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø´ØºÙ„ Plyr
            if (!plyrPlayer) {
                plyrPlayer = new Plyr('#player', {
                    controls: ['play-large', 'play', 'progress', 'current-time', 'mute', 'volume', 
                              'captions', 'settings', 'pip', 'airplay', 'fullscreen'],
                    settings: ['quality', 'speed'],
                    ratio: '16:9',
                    autoplay: true,
                    muted: !userInteracted, // ÙƒØªÙ… Ø§Ù„ØµÙˆØª Ø­ØªÙ‰ ÙŠØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    clickToPlay: true,
                    disableContextMenu: false,
                    loadSprite: true,
                    iconPrefix: 'plyr',
                    blankVideo: 'https://cdn.plyr.io/static/blank.mp4'
                });
                
                // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ù…Ø®ØµØµ Ù„Ù„ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙˆØ±Ø©
                addPiPButton();
                
                // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø£Ø­Ø¯Ø§Ø« Plyr
                plyrPlayer.on('ready', () => {
                    console.log("âœ… Plyr Ø¬Ø§Ù‡Ø²");
                });
                
                plyrPlayer.on('play', () => {
                    hideBufferIndicator();
                    updateQualityInfo();
                });
                
                plyrPlayer.on('waiting', () => {
                    showBufferIndicator();
                });
                
                plyrPlayer.on('canplay', () => {
                    hideBufferIndicator();
                });
            } else {
                // ØªØ­Ø¯ÙŠØ« Ù…ØµØ¯Ø± Plyr Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
                plyrPlayer.source = {
                    type: 'video',
                    title: 'DAMI X-PRO',
                    sources: [{ src: streamUrl, type: mimeType }],
                    poster: 'https://cdn-icons-png.flaticon.com/512/2965/2965363.png'
                };
            }
            
            // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø´ØºÙ„
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø©
            setTimeout(updateQualityInfo, 2000);
        }

        // ============= PICTURE-IN-PICTURE FEATURE =============
        function addPiPButton() {
            if (!document.pictureInPictureEnabled) return;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø²Ø± Ù…Ø®ØµØµ
            const pipButton = document.createElement('button');
            pipButton.className = 'plyr__control';
            pipButton.innerHTML = '<i class="fas fa-picture-in-picture"></i>';
            pipButton.title = 'Ø§Ù„ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙˆØ±Ø©';
            pipButton.addEventListener('click', togglePiP);
            
            // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø¹Ù†Ø§ØµØ± ØªØ­ÙƒÙ… Plyr
            const controls = document.querySelector('.plyr__controls');
            if (controls) {
                const fullscreenBtn = controls.querySelector('[data-plyr="fullscreen"]');
                if (fullscreenBtn) {
                    controls.insertBefore(pipButton, fullscreenBtn);
                }
            }
        }
        
        async function togglePiP() {
            const video = document.getElementById('player');
            
            try {
                if (video !== document.pictureInPictureElement) {
                    await video.requestPictureInPicture();
                    showPipNotification();
                    console.log("ğŸ–¼ï¸ ØªÙ… ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙˆØ±Ø©");
                } else {
                    await document.exitPictureInPicture();
                    console.log("ğŸ“º ØªÙ… Ø¥ØºÙ„Ø§Ù‚ ÙˆØ¶Ø¹ Ø§Ù„ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙˆØ±Ø©");
                }
            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ PiP:", error);
                showNotification("Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù…ØªØµÙØ­Ùƒ", "error");
            }
        }
        
        function showPipNotification() {
            const notification = document.getElementById('pipNotification');
            notification.style.display = 'block';
            notification.querySelector('span').textContent = translations[currentLang].pip_active;
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // ============= QUALITY & BUFFERING MANAGEMENT =============
        function setupQualitySelector(hls) {
            if (!hls || !hls.levels) return;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬ÙˆØ¯Ø©
            const qualities = hls.levels.map((level, index) => ({
                id: index,
                label: level.height + 'p',
                selected: index === hls.currentLevel
            }));
            
            // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Plyr
            if (plyrPlayer && plyrPlayer.elements && plyrPlayer.elements.settings) {
                // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© Ù‡Ù†Ø§
            }
        }
        
        function updateQualityInfo() {
            const video = document.getElementById('player');
            const qualityInfo = document.getElementById('qualityInfo');
            
            if (!video.videoWidth) return;
            
            const quality = video.videoHeight >= 1080 ? '1080p â€¢ 60fps' :
                          video.videoHeight >= 720 ? '720p â€¢ 30fps' :
                          video.videoHeight >= 480 ? '480p' : '360p';
            
            qualityInfo.textContent = quality;
            qualityInfo.classList.remove('hidden');
            
            // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 10 Ø«ÙˆØ§Ù†
            setTimeout(updateQualityInfo, 10000);
        }
        
        function showBufferIndicator() {
            if (isBuffering) return;
            
            isBuffering = true;
            const indicator = document.getElementById('bufferIndicator');
            if (indicator) {
                indicator.style.display = 'block';
            }
        }
        
        function hideBufferIndicator() {
            isBuffering = false;
            const indicator = document.getElementById('bufferIndicator');
            if (indicator) {
                indicator.style.display = 'none';
            }
        }

        // ============= ERROR HANDLING =============
        function handlePlaybackError(error, streamUrl) {
            console.error("ğŸš¨ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„:", error);
            showBufferIndicator();
            
            let errorMessage = "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„";
            
            if (error.type === 'NETWORK_ERROR') {
                errorMessage = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©. Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©...";
                setTimeout(() => {
                    console.log("ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ´ØºÙŠÙ„...");
                    const video = document.getElementById('player');
                    if (video) {
                        video.src = streamUrl;
                        safePlay(video);
                    }
                }, 3000);
            } else if (error.type === 'MEDIA_ERROR') {
                errorMessage = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ù„Ù. Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¨Ø¯ÙŠÙ„...";
                // Ù…Ø­Ø§ÙˆÙ„Ø© ØªÙ†Ø³ÙŠÙ‚ Ù…Ø®ØªÙ„Ù
                const altUrl = streamUrl.replace(/\.(m3u8|mp4)$/, '.mp4');
                console.log(`ğŸ”„ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø¨Ø¯ÙŠÙ„: ${altUrl}`);
                setTimeout(() => {
                    const video = document.getElementById('player');
                    video.src = altUrl;
                    safePlay(video);
                }, 2000);
            }
            
            showNotification(errorMessage, "error", 5000);
        }
        
        function showNotification(message, type = "info", duration = 3000) {
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ù…Ø¤Ù‚Øª
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-[9999] p-4 rounded-lg shadow-lg ${
                type === 'error' ? 'bg-red-600' : 
                type === 'warning' ? 'bg-yellow-600' : 'bg-green-600'
            } text-white`;
            notification.textContent = message;
            notification.style.animation = 'slideIn 0.3s ease';
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, duration);
        }

        // ============= EXISTING FUNCTIONS (UPDATED) =============
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('overlay').classList.toggle('hidden');
        }

        function openModal(id) {
            document.getElementById('modal-' + id).style.display = 'flex';
            toggleSidebar();
        }

        function closeModal(id) {
            document.getElementById('modal-' + id).style.display = 'none';
        }

        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const icon = document.getElementById('themeIcon');
            icon.className = document.body.classList.contains('light-mode') ? 'fas fa-sun' : 'fas fa-moon';
        }

        function changeLanguage(lang) {
            currentLang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.dataset.translate;
                if (translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });
            document.getElementById('searchInput').placeholder = translations[lang].search;
            fetchCategories();
        }

        window.onscroll = () => {
            const btn = document.getElementById('backToTop');
            btn.classList.toggle('show', window.scrollY > 400);
        };

        async function fetchAPI(action, params = {}) {
            const url = new URL(`${CONFIG.api.base}/player_api.php`);
            url.searchParams.append('username', CONFIG.api.user);
            url.searchParams.append('password', CONFIG.api.pass);
            url.searchParams.append('action', action);
            Object.keys(params).forEach(k => url.searchParams.append(k, params[k]));
            
            try {
                const res = await fetch(url);
                return await res.json();
            } catch (e) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", e);
                showNotification("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…", "error");
                return [];
            }
        }

        async function fetchCategories() {
            const action = currentMode === 'live' ? 'get_live_categories' : 
                          currentMode === 'movies' ? 'get_vod_categories' : 'get_series_categories';
            const cats = await fetchAPI(action);
            const container = document.getElementById('categoriesContainer');
            container.innerHTML = `<button onclick="loadCategory('all', this)" class="cat-btn whitespace-nowrap px-5 py-1 rounded-full bg-[var(--accent-color)] text-white text-sm font-bold">${translations[currentLang].all}</button>`;
            cats.forEach(c => {
                container.innerHTML += `<button onclick="loadCategory('${c.category_id}', this)" class="cat-btn whitespace-nowrap px-5 py-1 rounded-full bg-[var(--bg-card)] border border-[var(--border-color)] text-sm">${c.category_name}</button>`;
            });
            loadCategory('all');
        }

        async function loadCategory(id, btn) {
            if(btn) {
                document.querySelectorAll('.cat-btn').forEach(b => {
                    b.classList.remove('bg-[var(--accent-color)]', 'text-white', 'font-bold');
                    b.classList.add('bg-[var(--bg-card)]');
                });
                btn.classList.add('bg-[var(--accent-color)]', 'text-white', 'font-bold');
            }

            const grid = document.getElementById('contentGrid');
            const loader = document.getElementById('loader');
            grid.innerHTML = '';
            loader.classList.remove('hidden');
            
            const action = currentMode === 'live' ? 'get_live_streams' : 
                          currentMode === 'movies' ? 'get_vod_streams' : 'get_series';
            allData = await fetchAPI(action, id !== 'all' ? { category_id: id } : {});
            
            displayedCount = 0;
            loader.classList.add('hidden');
            loadMore();
        }

        function loadMore() {
            const grid = document.getElementById('contentGrid');
            const nextBatch = allData.slice(displayedCount, displayedCount + 30);
            
            nextBatch.forEach(item => {
                const card = document.createElement('div');
                card.className = 'media-card';
                
                const imgUrl = item.stream_icon || item.cover || 'https://via.placeholder.com/150';
                const ext = item.container_extension || 'mp4';
                const streamId = item.stream_id || item.vod_id || item.series_id;
                
                card.innerHTML = `
                    <div class="relative aspect-[2/3] overflow-hidden rounded-lg mb-2">
                        <img src="${imgUrl}" class="w-full h-full object-cover" loading="lazy" onerror="this.src='https://via.placeholder.com/150'">
                    </div>
                    <div class="text-xs font-bold truncate text-center">${item.name || item.title}</div>
                `;
                
                card.onclick = () => playStream(streamId, ext);
                grid.appendChild(card);
            });
            
            displayedCount += nextBatch.length;
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            if (loadMoreBtn) {
                loadMoreBtn.style.display = displayedCount < allData.length ? 'block' : 'none';
            }
        }

        function switchMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
            fetchCategories();
        }

        // ============= INITIALIZATION =============
        document.addEventListener('DOMContentLoaded', () => {
            console.log("ğŸš€ DAMI X-PRO Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©...");
            
            // ØªÙ‡ÙŠØ¦Ø© Ù…Ø´ØºÙ„ Plyr
            plyrPlayer = new Plyr('#player', {
                controls: ['play-large', 'play', 'progress', 'current-time', 'mute', 'volume', 
                          'captions', 'settings', 'pip', 'airplay', 'fullscreen'],
                settings: ['quality', 'speed'],
                ratio: '16:9',
                autoplay: false, // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Chrome
                clickToPlay: true,
                hideControls: false,
                resetOnEnd: false,
                seekTime: 10,
                volume: 0.5,
                debug: false
            });
            
            // ØªÙØ¹ÙŠÙ„ Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
            initAutoplayHelper();
            
            // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø³Ù†Ø©
            document.getElementById('year').textContent = new Date().getFullYear();
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„ØºØ©
            changeLanguage('ar');
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø§Ù„Ø¨Ø­Ø«
            document.getElementById('searchInput').addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = allData.filter(i => 
                    (i.name || i.title || "").toLowerCase().includes(term)
                ).slice(0, 30);
                
                const grid = document.getElementById('contentGrid');
                grid.innerHTML = '';
                
                filtered.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'media-card';
                    const imgUrl = item.stream_icon || item.cover || 'https://via.placeholder.com/150';
                    const streamId = item.stream_id || item.vod_id || item.series_id;
                    const ext = item.container_extension || 'mp4';

                    card.innerHTML = `
                        <div class="relative aspect-[2/3] overflow-hidden rounded-lg mb-2">
                            <img src="${imgUrl}" class="w-full h-full object-cover">
                        </div>
                        <div class="text-xs font-bold truncate text-center mt-2">${item.name || item.title}</div>
                    `;
                    card.onclick = () => playStream(streamId, ext);
                    grid.appendChild(card);
                });
            });
            
            console.log("âœ… DAMI X-PRO Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…!");
        });
    </script>

</body>
</html>
