<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DAMI X-PRO</title>

<link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.10"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">

<style>
:root{
--bg:#050505;--card:#121212;--text:#fff;--accent:#d4af37
}
.light-mode{
--bg:#f0f2f5;--card:#fff;--text:#050505;--accent:#1877f2
}
body{background:var(--bg);color:var(--text);font-family:Cairo}
</style>
</head>

<body>

<!-- PLAYER -->
<div class="w-full bg-black flex justify-center sticky top-0 z-50">
<video
id="player"
class="w-full max-w-5xl aspect-video"
playsinline
muted
controls
preload="metadata"
crossorigin="anonymous">
</video>
</div>

<!-- UI -->
<div class="p-4 text-center">
<button onclick="switchMode('live')" class="px-4 py-2 bg-[var(--accent)] text-white rounded">مباشر</button>
<button onclick="switchMode('movies')" class="px-4 py-2 border rounded">أفلام</button>
</div>

<div id="contentGrid" class="grid grid-cols-2 sm:grid-cols-4 gap-4 p-4"></div>

<script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>

<script>
/* ================= CONFIG ================= */
const CONFIG = {
 api:{
  base:"https://x-api.uk",
  user:"SoH1THYeDSG",
  pass:"F9cjyKSHEFd"
 }
};

let currentMode='live';
let hlsInstance=null;
let plyrPlayer=null;

/* ================= INIT ================= */
document.addEventListener('DOMContentLoaded',()=>{
 plyrPlayer=new Plyr('#player',{
  autoplay:false,
  muted:true,
  clickToPlay:true,
  controls:['play-large','play','progress','current-time','mute','volume','settings','fullscreen']
 });
 loadDemo();
});

/* ================= PLAY ENGINE ================= */
function playStream(id){
 const video=document.getElementById('player');

 if(hlsInstance){
  hlsInstance.destroy();
  hlsInstance=null;
 }

 video.pause();
 video.removeAttribute('src');
 video.load();

 if(currentMode==='live'){
  const url=`${CONFIG.api.base}/live/${CONFIG.api.user}/${CONFIG.api.pass}/${id}.m3u8`;

  if(Hls.isSupported()){
   hlsInstance=new Hls({lowLatencyMode:true});
   hlsInstance.loadSource(url);
   hlsInstance.attachMedia(video);
  }else if(video.canPlayType('application/vnd.apple.mpegurl')){
   video.src=url;
  }
 }else{
  const url=`${CONFIG.api.base}/movie/${CONFIG.api.user}/${CONFIG.api.pass}/${id}.mp4`;
  plyrPlayer.source={
   type:'video',
   sources:[{src:url,type:'video/mp4'}]
  };
 }

 setTimeout(()=>{
  video.muted=true;
  video.play().catch(()=>console.log('Chrome منع autoplay'));
 },300);

 window.scrollTo({top:0,behavior:'smooth'});
}

/* ================= MODE ================= */
function switchMode(mode){
 currentMode=mode;
 loadDemo();
}

/* ================= DEMO CONTENT ================= */
function loadDemo(){
 const grid=document.getElementById('contentGrid');
 grid.innerHTML='';
 for(let i=1;i<=8;i++){
  const d=document.createElement('div');
  d.className='bg-[var(--card)] p-2 rounded cursor-pointer text-center';
  d.innerHTML=`<div class="aspect-[2/3] bg-gray-700 mb-2"></div><div>Channel ${i}</div>`;
  d.onclick=()=>playStream(i);
  grid.appendChild(d);
 }
}
</script>

</body>
</html>
